[2025-05-19 00:44:04,382] INFO in main: Embrapa API started in development mode.
[2025-05-19 00:44:24,215] INFO in main: Embrapa API is shutting down.
[2025-05-19 00:44:48,427] INFO in main: Embrapa API started in development mode.
[2025-05-19 00:47:43,749] INFO in main: Embrapa API is shutting down.
[2025-05-19 00:47:44,337] INFO in main: Embrapa API started in development mode.
[2025-05-19 00:49:16,153] INFO in main: Root endpoint accessed.
[2025-05-19 00:49:17,227] INFO in main: Root endpoint accessed.
[2025-05-19 00:49:18,016] INFO in main: Root endpoint accessed.
[2025-05-19 00:49:18,738] INFO in main: Root endpoint accessed.
[2025-05-19 00:49:19,268] INFO in main: Root endpoint accessed.
[2025-05-19 00:49:19,501] INFO in main: Root endpoint accessed.
[2025-05-19 00:49:27,381] INFO in main: Embrapa API is shutting down.
[2025-05-19 00:49:28,057] INFO in main: Embrapa API started in development mode.
[2025-05-19 00:49:30,319] INFO in main: Embrapa API is shutting down.
[2025-05-19 00:49:31,243] INFO in main: Embrapa API started in development mode.
[2025-05-19 00:49:37,801] INFO in main: Root endpoint accessed.
[2025-05-19 00:49:38,481] INFO in main: Root endpoint accessed.
[2025-05-19 00:49:39,097] INFO in main: Root endpoint accessed.
[2025-05-19 00:49:39,349] INFO in main: Root endpoint accessed.
[2025-05-19 00:49:40,727] INFO in main: Root endpoint accessed.
[2025-05-19 00:49:45,150] INFO in main: Root endpoint accessed.
[2025-05-19 00:49:53,967] INFO in main: Embrapa API is shutting down.
[2025-05-19 00:49:54,632] INFO in main: Embrapa API started in development mode.
[2025-05-19 00:49:56,091] INFO in main: Embrapa API is shutting down.
[2025-05-19 00:49:56,731] INFO in main: Embrapa API started in development mode.
[2025-05-19 00:49:58,736] INFO in main: Embrapa API is shutting down.
[2025-05-19 00:50:04,675] INFO in main: Embrapa API started in development mode.
[2025-05-19 00:50:05,986] INFO in main: Root endpoint accessed.
[2025-05-19 00:52:42,958] INFO in main: Embrapa API is shutting down.
[2025-05-19 21:27:11,324] INFO in main: Embrapa API started in development mode.
[2025-05-19 21:28:24,332] INFO in main: Embrapa API is shutting down.
[2025-05-19 22:18:51,499] INFO in main: Embrapa API started in development mode.
[2025-05-19 22:19:24,271] INFO in main: Embrapa API started in development mode.
[2025-05-19 22:19:38,414] INFO in main: Embrapa API is shutting down.
[2025-05-19 22:19:56,271] INFO in main: Embrapa API started in development mode.
[2025-05-19 22:22:54,168] INFO in main: Embrapa API is shutting down.
[2025-05-19 22:24:16,069] INFO in main: Embrapa API started in development mode.
[2025-05-19 22:24:16,872] INFO in main: Embrapa API started in development mode.
[2025-05-19 22:24:17,677] INFO in main: Embrapa API started in development mode.
[2025-05-19 22:24:18,425] INFO in main: Embrapa API started in development mode.
[2025-05-19 22:24:48,423] INFO in main: Embrapa API is shutting down.
[2025-05-19 22:24:49,092] INFO in main: Embrapa API started in development mode.
[2025-05-19 22:24:49,828] INFO in main: Embrapa API started in development mode.
[2025-05-19 22:24:50,779] INFO in main: Embrapa API is shutting down.
[2025-05-19 22:24:51,511] INFO in main: Embrapa API started in development mode.
[2025-05-19 22:26:27,677] INFO in main: Embrapa API started in development mode.
[2025-05-19 22:26:32,831] INFO in main: Embrapa API is shutting down.
[2025-05-19 22:26:40,536] INFO in main: Embrapa API started in development mode.
[2025-05-19 22:27:48,015] INFO in main: Embrapa API is shutting down.
[2025-05-19 22:27:54,763] INFO in main: Embrapa API started in development mode.
[2025-05-19 22:29:17,114] INFO in main: Embrapa API is shutting down.
[2025-05-19 22:29:17,817] INFO in main: Embrapa API started in development mode.
[2025-05-19 22:29:18,638] INFO in main: Embrapa API started in development mode.
[2025-05-19 22:29:23,615] INFO in main: Embrapa API is shutting down.
[2025-05-19 22:29:28,725] INFO in main: Embrapa API started in development mode.
[2025-05-19 22:31:11,424] INFO in main: Embrapa API is shutting down.
[2025-05-19 22:32:23,444] INFO in main: Embrapa API started in development mode.
[2025-05-19 22:34:35,583] INFO in main: Embrapa API is shutting down.
[2025-05-19 22:35:09,533] INFO in main: Embrapa API started in development mode.
[2025-05-19 22:35:15,752] INFO in main: Embrapa API is shutting down.
[2025-05-19 22:35:20,901] INFO in main: Embrapa API started in development mode.
[2025-05-19 22:37:19,787] INFO in main: Embrapa API is shutting down.
[2025-05-19 22:37:52,065] INFO in main: Embrapa API started in development mode.
[2025-05-19 22:38:00,046] INFO in main: Root endpoint accessed.
[2025-05-19 22:38:39,720] INFO in main: Embrapa API is shutting down.
[2025-05-19 22:38:57,158] INFO in main: Embrapa API started in development mode.
[2025-05-19 22:45:59,059] INFO in main: Embrapa API is shutting down.
[2025-05-19 22:55:33,886] INFO in main: Embrapa API started in development mode.
[2025-05-19 22:56:32,301] INFO in main: Embrapa API is shutting down.
[2025-05-19 22:56:43,183] INFO in main: Embrapa API started in development mode.
[2025-05-19 22:57:02,247] ERROR in production: Error scraping production data: [WinError 10054] Foi forçado o cancelamento de uma conexão existente pelo host remoto
[2025-05-19 22:59:30,670] INFO in main: Embrapa API is shutting down.
[2025-05-19 22:59:31,947] INFO in main: Embrapa API started in development mode.
[2025-05-19 23:00:15,561] INFO in main: Embrapa API is shutting down.
[2025-05-19 23:01:12,296] INFO in main: Embrapa API started in development mode.
[2025-05-19 23:01:25,462] ERROR in production: Error scraping production data:
Traceback (most recent call last):
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 101, in map_httpcore_exceptions
    yield
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 250, in handle_request
    resp = self._pool.handle_request(req)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection_pool.py", line 256, in handle_request
    raise exc from None
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection_pool.py", line 236, in handle_request
    response = connection.handle_request(
        pool_request.request
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection.py", line 101, in handle_request
    raise exc
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection.py", line 78, in handle_request
    stream = self._connect(request)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection.py", line 156, in _connect
    stream = stream.start_tls(**kwargs)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_backends\sync.py", line 154, in start_tls
    with map_exceptions(exc_map):
         ~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\pivac\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [WinError 10054] Foi forçado o cancelamento de uma conexão existente pelo host remoto

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\PosML\Fase 1\techchallenge\embrapa_api\app\scraping\production.py", line 12, in fetch_production_data
    response = httpx.get(url, timeout=10)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_api.py", line 195, in get
    return request(
        "GET",
    ...<9 lines>...
        trust_env=trust_env,
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_api.py", line 109, in request
    return client.request(
           ~~~~~~~~~~~~~~^
        method=method,
        ^^^^^^^^^^^^^^
    ...<8 lines>...
        follow_redirects=follow_redirects,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 825, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 914, in send
    response = self._send_handling_auth(
        request,
    ...<2 lines>...
        history=[],
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
        request,
        follow_redirects=follow_redirects,
        history=history,
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 1014, in _send_single_request
    response = transport.handle_request(request)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 249, in handle_request
    with map_httpcore_exceptions():
         ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\pivac\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 118, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [WinError 10054] Foi forçado o cancelamento de uma conexão existente pelo host remoto

[2025-05-19 23:03:17,607] ERROR in production: Error scraping production data:
Traceback (most recent call last):
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 101, in map_httpcore_exceptions
    yield
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 250, in handle_request
    resp = self._pool.handle_request(req)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection_pool.py", line 256, in handle_request
    raise exc from None
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection_pool.py", line 236, in handle_request
    response = connection.handle_request(
        pool_request.request
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection.py", line 101, in handle_request
    raise exc
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection.py", line 78, in handle_request
    stream = self._connect(request)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection.py", line 156, in _connect
    stream = stream.start_tls(**kwargs)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_backends\sync.py", line 154, in start_tls
    with map_exceptions(exc_map):
         ~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\pivac\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [WinError 10054] Foi forçado o cancelamento de uma conexão existente pelo host remoto

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\PosML\Fase 1\techchallenge\embrapa_api\app\scraping\production.py", line 12, in fetch_production_data
    response = httpx.get(url, timeout=10)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_api.py", line 195, in get
    return request(
        "GET",
    ...<9 lines>...
        trust_env=trust_env,
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_api.py", line 109, in request
    return client.request(
           ~~~~~~~~~~~~~~^
        method=method,
        ^^^^^^^^^^^^^^
    ...<8 lines>...
        follow_redirects=follow_redirects,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 825, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 914, in send
    response = self._send_handling_auth(
        request,
    ...<2 lines>...
        history=[],
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
        request,
        follow_redirects=follow_redirects,
        history=history,
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 1014, in _send_single_request
    response = transport.handle_request(request)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 249, in handle_request
    with map_httpcore_exceptions():
         ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\pivac\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 118, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [WinError 10054] Foi forçado o cancelamento de uma conexão existente pelo host remoto

[2025-05-19 23:04:07,487] INFO in main: Embrapa API is shutting down.
[2025-05-19 23:04:08,791] INFO in main: Embrapa API started in development mode.
[2025-05-19 23:04:10,110] INFO in main: Embrapa API started in development mode.
[2025-05-19 23:04:27,092] INFO in main: Embrapa API is shutting down.
[2025-05-19 23:04:28,357] INFO in main: Embrapa API started in development mode.
[2025-05-19 23:04:29,616] INFO in main: Embrapa API started in development mode.
[2025-05-19 23:04:34,498] INFO in main: Embrapa API is shutting down.
[2025-05-19 23:04:35,722] INFO in main: Embrapa API started in development mode.
[2025-05-19 23:04:37,181] INFO in main: Embrapa API is shutting down.
[2025-05-19 23:04:38,465] INFO in main: Embrapa API started in development mode.
[2025-05-19 23:04:44,965] INFO in main: Embrapa API is shutting down.
[2025-05-19 23:04:52,810] INFO in main: Embrapa API started in development mode.
[2025-05-19 23:04:56,390] ERROR in production: Error scraping production data:
Traceback (most recent call last):
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 101, in map_httpcore_exceptions
    yield
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 250, in handle_request
    resp = self._pool.handle_request(req)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection_pool.py", line 256, in handle_request
    raise exc from None
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection_pool.py", line 236, in handle_request
    response = connection.handle_request(
        pool_request.request
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection.py", line 101, in handle_request
    raise exc
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection.py", line 78, in handle_request
    stream = self._connect(request)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection.py", line 156, in _connect
    stream = stream.start_tls(**kwargs)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_backends\sync.py", line 154, in start_tls
    with map_exceptions(exc_map):
         ~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\pivac\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [WinError 10054] Foi forçado o cancelamento de uma conexão existente pelo host remoto

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\PosML\Fase 1\techchallenge\embrapa_api\app\scraping\production.py", line 12, in fetch_production_data
    response = httpx.get(url, timeout=10)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_api.py", line 195, in get
    return request(
        "GET",
    ...<9 lines>...
        trust_env=trust_env,
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_api.py", line 109, in request
    return client.request(
           ~~~~~~~~~~~~~~^
        method=method,
        ^^^^^^^^^^^^^^
    ...<8 lines>...
        follow_redirects=follow_redirects,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 825, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 914, in send
    response = self._send_handling_auth(
        request,
    ...<2 lines>...
        history=[],
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
        request,
        follow_redirects=follow_redirects,
        history=history,
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 1014, in _send_single_request
    response = transport.handle_request(request)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 249, in handle_request
    with map_httpcore_exceptions():
         ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\pivac\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 118, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [WinError 10054] Foi forçado o cancelamento de uma conexão existente pelo host remoto

[2025-05-19 23:06:32,008] INFO in main: Embrapa API is shutting down.
[2025-05-19 23:08:00,711] INFO in main: Embrapa API started in development mode.
[2025-05-19 23:08:04,553] ERROR in production: Error scraping production data:
Traceback (most recent call last):
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 101, in map_httpcore_exceptions
    yield
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 250, in handle_request
    resp = self._pool.handle_request(req)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection_pool.py", line 256, in handle_request
    raise exc from None
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection_pool.py", line 236, in handle_request
    response = connection.handle_request(
        pool_request.request
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection.py", line 101, in handle_request
    raise exc
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection.py", line 78, in handle_request
    stream = self._connect(request)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection.py", line 156, in _connect
    stream = stream.start_tls(**kwargs)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_backends\sync.py", line 154, in start_tls
    with map_exceptions(exc_map):
         ~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\pivac\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [WinError 10054] Foi forçado o cancelamento de uma conexão existente pelo host remoto

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\PosML\Fase 1\techchallenge\embrapa_api\app\scraping\production.py", line 12, in fetch_production_data
    response = httpx.get(url, timeout=10)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_api.py", line 195, in get
    return request(
        "GET",
    ...<9 lines>...
        trust_env=trust_env,
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_api.py", line 109, in request
    return client.request(
           ~~~~~~~~~~~~~~^
        method=method,
        ^^^^^^^^^^^^^^
    ...<8 lines>...
        follow_redirects=follow_redirects,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 825, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 914, in send
    response = self._send_handling_auth(
        request,
    ...<2 lines>...
        history=[],
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
        request,
        follow_redirects=follow_redirects,
        history=history,
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 1014, in _send_single_request
    response = transport.handle_request(request)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 249, in handle_request
    with map_httpcore_exceptions():
         ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\pivac\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 118, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [WinError 10054] Foi forçado o cancelamento de uma conexão existente pelo host remoto

[2025-05-19 23:08:07,804] ERROR in production: Error scraping production data:
Traceback (most recent call last):
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 101, in map_httpcore_exceptions
    yield
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 250, in handle_request
    resp = self._pool.handle_request(req)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection_pool.py", line 256, in handle_request
    raise exc from None
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection_pool.py", line 236, in handle_request
    response = connection.handle_request(
        pool_request.request
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection.py", line 101, in handle_request
    raise exc
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection.py", line 78, in handle_request
    stream = self._connect(request)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection.py", line 156, in _connect
    stream = stream.start_tls(**kwargs)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_backends\sync.py", line 154, in start_tls
    with map_exceptions(exc_map):
         ~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\pivac\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [WinError 10054] Foi forçado o cancelamento de uma conexão existente pelo host remoto

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\PosML\Fase 1\techchallenge\embrapa_api\app\scraping\production.py", line 12, in fetch_production_data
    response = httpx.get(url, timeout=10)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_api.py", line 195, in get
    return request(
        "GET",
    ...<9 lines>...
        trust_env=trust_env,
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_api.py", line 109, in request
    return client.request(
           ~~~~~~~~~~~~~~^
        method=method,
        ^^^^^^^^^^^^^^
    ...<8 lines>...
        follow_redirects=follow_redirects,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 825, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 914, in send
    response = self._send_handling_auth(
        request,
    ...<2 lines>...
        history=[],
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
        request,
        follow_redirects=follow_redirects,
        history=history,
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 1014, in _send_single_request
    response = transport.handle_request(request)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 249, in handle_request
    with map_httpcore_exceptions():
         ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\pivac\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 118, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [WinError 10054] Foi forçado o cancelamento de uma conexão existente pelo host remoto

[2025-05-19 23:08:08,883] ERROR in production: Error scraping production data:
Traceback (most recent call last):
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 101, in map_httpcore_exceptions
    yield
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 250, in handle_request
    resp = self._pool.handle_request(req)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection_pool.py", line 256, in handle_request
    raise exc from None
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection_pool.py", line 236, in handle_request
    response = connection.handle_request(
        pool_request.request
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection.py", line 101, in handle_request
    raise exc
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection.py", line 78, in handle_request
    stream = self._connect(request)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection.py", line 156, in _connect
    stream = stream.start_tls(**kwargs)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_backends\sync.py", line 154, in start_tls
    with map_exceptions(exc_map):
         ~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\pivac\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [WinError 10054] Foi forçado o cancelamento de uma conexão existente pelo host remoto

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\PosML\Fase 1\techchallenge\embrapa_api\app\scraping\production.py", line 12, in fetch_production_data
    response = httpx.get(url, timeout=10)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_api.py", line 195, in get
    return request(
        "GET",
    ...<9 lines>...
        trust_env=trust_env,
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_api.py", line 109, in request
    return client.request(
           ~~~~~~~~~~~~~~^
        method=method,
        ^^^^^^^^^^^^^^
    ...<8 lines>...
        follow_redirects=follow_redirects,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 825, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 914, in send
    response = self._send_handling_auth(
        request,
    ...<2 lines>...
        history=[],
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
        request,
        follow_redirects=follow_redirects,
        history=history,
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 1014, in _send_single_request
    response = transport.handle_request(request)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 249, in handle_request
    with map_httpcore_exceptions():
         ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\pivac\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 118, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [WinError 10054] Foi forçado o cancelamento de uma conexão existente pelo host remoto

[2025-05-19 23:08:09,854] ERROR in production: Error scraping production data:
Traceback (most recent call last):
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 101, in map_httpcore_exceptions
    yield
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 250, in handle_request
    resp = self._pool.handle_request(req)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection_pool.py", line 256, in handle_request
    raise exc from None
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection_pool.py", line 236, in handle_request
    response = connection.handle_request(
        pool_request.request
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection.py", line 101, in handle_request
    raise exc
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection.py", line 78, in handle_request
    stream = self._connect(request)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection.py", line 156, in _connect
    stream = stream.start_tls(**kwargs)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_backends\sync.py", line 154, in start_tls
    with map_exceptions(exc_map):
         ~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\pivac\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [WinError 10054] Foi forçado o cancelamento de uma conexão existente pelo host remoto

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\PosML\Fase 1\techchallenge\embrapa_api\app\scraping\production.py", line 12, in fetch_production_data
    response = httpx.get(url, timeout=10)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_api.py", line 195, in get
    return request(
        "GET",
    ...<9 lines>...
        trust_env=trust_env,
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_api.py", line 109, in request
    return client.request(
           ~~~~~~~~~~~~~~^
        method=method,
        ^^^^^^^^^^^^^^
    ...<8 lines>...
        follow_redirects=follow_redirects,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 825, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 914, in send
    response = self._send_handling_auth(
        request,
    ...<2 lines>...
        history=[],
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
        request,
        follow_redirects=follow_redirects,
        history=history,
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 1014, in _send_single_request
    response = transport.handle_request(request)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 249, in handle_request
    with map_httpcore_exceptions():
         ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\pivac\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 118, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [WinError 10054] Foi forçado o cancelamento de uma conexão existente pelo host remoto

[2025-05-19 23:10:10,049] INFO in main: Embrapa API is shutting down.
[2025-05-19 23:10:11,309] INFO in main: Embrapa API started in development mode.
[2025-05-19 23:10:13,699] INFO in main: Embrapa API is shutting down.
[2025-05-19 23:10:14,907] INFO in main: Embrapa API started in development mode.
[2025-05-19 23:10:15,173] INFO in main: Embrapa API is shutting down.
[2025-05-19 23:10:20,664] INFO in main: Embrapa API started in development mode.
[2025-05-19 23:10:22,647] ERROR in production: Error scraping production data:
Traceback (most recent call last):
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 101, in map_httpcore_exceptions
    yield
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 250, in handle_request
    resp = self._pool.handle_request(req)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection_pool.py", line 256, in handle_request
    raise exc from None
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection_pool.py", line 236, in handle_request
    response = connection.handle_request(
        pool_request.request
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection.py", line 101, in handle_request
    raise exc
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection.py", line 78, in handle_request
    stream = self._connect(request)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection.py", line 156, in _connect
    stream = stream.start_tls(**kwargs)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_backends\sync.py", line 154, in start_tls
    with map_exceptions(exc_map):
         ~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\pivac\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [WinError 10054] Foi forçado o cancelamento de uma conexão existente pelo host remoto

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\PosML\Fase 1\techchallenge\embrapa_api\app\scraping\production.py", line 12, in fetch_production_data
    response = httpx.get(url, timeout=10)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_api.py", line 195, in get
    return request(
        "GET",
    ...<9 lines>...
        trust_env=trust_env,
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_api.py", line 109, in request
    return client.request(
           ~~~~~~~~~~~~~~^
        method=method,
        ^^^^^^^^^^^^^^
    ...<8 lines>...
        follow_redirects=follow_redirects,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 825, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 914, in send
    response = self._send_handling_auth(
        request,
    ...<2 lines>...
        history=[],
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
        request,
        follow_redirects=follow_redirects,
        history=history,
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 1014, in _send_single_request
    response = transport.handle_request(request)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 249, in handle_request
    with map_httpcore_exceptions():
         ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\pivac\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 118, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [WinError 10054] Foi forçado o cancelamento de uma conexão existente pelo host remoto

[2025-05-19 23:10:24,216] ERROR in production: Error scraping production data:
Traceback (most recent call last):
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 101, in map_httpcore_exceptions
    yield
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 250, in handle_request
    resp = self._pool.handle_request(req)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection_pool.py", line 256, in handle_request
    raise exc from None
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection_pool.py", line 236, in handle_request
    response = connection.handle_request(
        pool_request.request
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection.py", line 101, in handle_request
    raise exc
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection.py", line 78, in handle_request
    stream = self._connect(request)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection.py", line 156, in _connect
    stream = stream.start_tls(**kwargs)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_backends\sync.py", line 154, in start_tls
    with map_exceptions(exc_map):
         ~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\pivac\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [WinError 10054] Foi forçado o cancelamento de uma conexão existente pelo host remoto

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\PosML\Fase 1\techchallenge\embrapa_api\app\scraping\production.py", line 12, in fetch_production_data
    response = httpx.get(url, timeout=10)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_api.py", line 195, in get
    return request(
        "GET",
    ...<9 lines>...
        trust_env=trust_env,
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_api.py", line 109, in request
    return client.request(
           ~~~~~~~~~~~~~~^
        method=method,
        ^^^^^^^^^^^^^^
    ...<8 lines>...
        follow_redirects=follow_redirects,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 825, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 914, in send
    response = self._send_handling_auth(
        request,
    ...<2 lines>...
        history=[],
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
        request,
        follow_redirects=follow_redirects,
        history=history,
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 1014, in _send_single_request
    response = transport.handle_request(request)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 249, in handle_request
    with map_httpcore_exceptions():
         ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\pivac\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 118, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [WinError 10054] Foi forçado o cancelamento de uma conexão existente pelo host remoto

[2025-05-19 23:10:25,520] ERROR in production: Error scraping production data:
Traceback (most recent call last):
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 101, in map_httpcore_exceptions
    yield
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 250, in handle_request
    resp = self._pool.handle_request(req)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection_pool.py", line 256, in handle_request
    raise exc from None
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection_pool.py", line 236, in handle_request
    response = connection.handle_request(
        pool_request.request
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection.py", line 101, in handle_request
    raise exc
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection.py", line 78, in handle_request
    stream = self._connect(request)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection.py", line 156, in _connect
    stream = stream.start_tls(**kwargs)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_backends\sync.py", line 154, in start_tls
    with map_exceptions(exc_map):
         ~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\pivac\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [WinError 10054] Foi forçado o cancelamento de uma conexão existente pelo host remoto

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\PosML\Fase 1\techchallenge\embrapa_api\app\scraping\production.py", line 12, in fetch_production_data
    response = httpx.get(url, timeout=10)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_api.py", line 195, in get
    return request(
        "GET",
    ...<9 lines>...
        trust_env=trust_env,
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_api.py", line 109, in request
    return client.request(
           ~~~~~~~~~~~~~~^
        method=method,
        ^^^^^^^^^^^^^^
    ...<8 lines>...
        follow_redirects=follow_redirects,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 825, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 914, in send
    response = self._send_handling_auth(
        request,
    ...<2 lines>...
        history=[],
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
        request,
        follow_redirects=follow_redirects,
        history=history,
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 1014, in _send_single_request
    response = transport.handle_request(request)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 249, in handle_request
    with map_httpcore_exceptions():
         ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\pivac\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 118, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [WinError 10054] Foi forçado o cancelamento de uma conexão existente pelo host remoto

[2025-05-19 23:10:26,827] ERROR in production: Error scraping production data:
Traceback (most recent call last):
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 101, in map_httpcore_exceptions
    yield
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 250, in handle_request
    resp = self._pool.handle_request(req)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection_pool.py", line 256, in handle_request
    raise exc from None
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection_pool.py", line 236, in handle_request
    response = connection.handle_request(
        pool_request.request
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection.py", line 101, in handle_request
    raise exc
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection.py", line 78, in handle_request
    stream = self._connect(request)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection.py", line 156, in _connect
    stream = stream.start_tls(**kwargs)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_backends\sync.py", line 154, in start_tls
    with map_exceptions(exc_map):
         ~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\pivac\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [WinError 10054] Foi forçado o cancelamento de uma conexão existente pelo host remoto

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\PosML\Fase 1\techchallenge\embrapa_api\app\scraping\production.py", line 12, in fetch_production_data
    response = httpx.get(url, timeout=10)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_api.py", line 195, in get
    return request(
        "GET",
    ...<9 lines>...
        trust_env=trust_env,
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_api.py", line 109, in request
    return client.request(
           ~~~~~~~~~~~~~~^
        method=method,
        ^^^^^^^^^^^^^^
    ...<8 lines>...
        follow_redirects=follow_redirects,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 825, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 914, in send
    response = self._send_handling_auth(
        request,
    ...<2 lines>...
        history=[],
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
        request,
        follow_redirects=follow_redirects,
        history=history,
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 1014, in _send_single_request
    response = transport.handle_request(request)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 249, in handle_request
    with map_httpcore_exceptions():
         ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\pivac\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 118, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [WinError 10054] Foi forçado o cancelamento de uma conexão existente pelo host remoto

[2025-05-19 23:10:28,093] ERROR in production: Error scraping production data:
Traceback (most recent call last):
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 101, in map_httpcore_exceptions
    yield
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 250, in handle_request
    resp = self._pool.handle_request(req)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection_pool.py", line 256, in handle_request
    raise exc from None
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection_pool.py", line 236, in handle_request
    response = connection.handle_request(
        pool_request.request
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection.py", line 101, in handle_request
    raise exc
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection.py", line 78, in handle_request
    stream = self._connect(request)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection.py", line 156, in _connect
    stream = stream.start_tls(**kwargs)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_backends\sync.py", line 154, in start_tls
    with map_exceptions(exc_map):
         ~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\pivac\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [WinError 10054] Foi forçado o cancelamento de uma conexão existente pelo host remoto

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\PosML\Fase 1\techchallenge\embrapa_api\app\scraping\production.py", line 12, in fetch_production_data
    response = httpx.get(url, timeout=10)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_api.py", line 195, in get
    return request(
        "GET",
    ...<9 lines>...
        trust_env=trust_env,
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_api.py", line 109, in request
    return client.request(
           ~~~~~~~~~~~~~~^
        method=method,
        ^^^^^^^^^^^^^^
    ...<8 lines>...
        follow_redirects=follow_redirects,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 825, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 914, in send
    response = self._send_handling_auth(
        request,
    ...<2 lines>...
        history=[],
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
        request,
        follow_redirects=follow_redirects,
        history=history,
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 1014, in _send_single_request
    response = transport.handle_request(request)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 249, in handle_request
    with map_httpcore_exceptions():
         ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\pivac\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 118, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [WinError 10054] Foi forçado o cancelamento de uma conexão existente pelo host remoto

[2025-05-19 23:10:47,415] ERROR in production: Error scraping production data:
Traceback (most recent call last):
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 101, in map_httpcore_exceptions
    yield
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 250, in handle_request
    resp = self._pool.handle_request(req)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection_pool.py", line 256, in handle_request
    raise exc from None
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection_pool.py", line 236, in handle_request
    response = connection.handle_request(
        pool_request.request
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection.py", line 101, in handle_request
    raise exc
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection.py", line 78, in handle_request
    stream = self._connect(request)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection.py", line 156, in _connect
    stream = stream.start_tls(**kwargs)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_backends\sync.py", line 154, in start_tls
    with map_exceptions(exc_map):
         ~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\pivac\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [WinError 10054] Foi forçado o cancelamento de uma conexão existente pelo host remoto

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\PosML\Fase 1\techchallenge\embrapa_api\app\scraping\production.py", line 12, in fetch_production_data
    response = httpx.get(url, timeout=10)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_api.py", line 195, in get
    return request(
        "GET",
    ...<9 lines>...
        trust_env=trust_env,
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_api.py", line 109, in request
    return client.request(
           ~~~~~~~~~~~~~~^
        method=method,
        ^^^^^^^^^^^^^^
    ...<8 lines>...
        follow_redirects=follow_redirects,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 825, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 914, in send
    response = self._send_handling_auth(
        request,
    ...<2 lines>...
        history=[],
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
        request,
        follow_redirects=follow_redirects,
        history=history,
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 1014, in _send_single_request
    response = transport.handle_request(request)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 249, in handle_request
    with map_httpcore_exceptions():
         ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\pivac\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 118, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [WinError 10054] Foi forçado o cancelamento de uma conexão existente pelo host remoto

[2025-05-19 23:12:59,342] INFO in main: Embrapa API is shutting down.
[2025-05-19 23:13:00,640] INFO in main: Embrapa API started in development mode.
[2025-05-19 23:13:09,119] INFO in main: Embrapa API is shutting down.
[2025-05-19 23:13:10,422] INFO in main: Embrapa API started in development mode.
[2025-05-19 23:13:16,799] INFO in main: Embrapa API is shutting down.
[2025-05-19 23:13:22,224] INFO in main: Embrapa API started in development mode.
[2025-05-19 23:13:28,557] ERROR in production: Error scraping production data:
Traceback (most recent call last):
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 101, in map_httpcore_exceptions
    yield
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 250, in handle_request
    resp = self._pool.handle_request(req)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection_pool.py", line 256, in handle_request
    raise exc from None
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection_pool.py", line 236, in handle_request
    response = connection.handle_request(
        pool_request.request
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection.py", line 101, in handle_request
    raise exc
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection.py", line 78, in handle_request
    stream = self._connect(request)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection.py", line 156, in _connect
    stream = stream.start_tls(**kwargs)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_backends\sync.py", line 154, in start_tls
    with map_exceptions(exc_map):
         ~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\pivac\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [WinError 10054] Foi forçado o cancelamento de uma conexão existente pelo host remoto

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\PosML\Fase 1\techchallenge\embrapa_api\app\scraping\production.py", line 12, in fetch_production_data
    response = httpx.get(url, timeout=10)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_api.py", line 195, in get
    return request(
        "GET",
    ...<9 lines>...
        trust_env=trust_env,
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_api.py", line 109, in request
    return client.request(
           ~~~~~~~~~~~~~~^
        method=method,
        ^^^^^^^^^^^^^^
    ...<8 lines>...
        follow_redirects=follow_redirects,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 825, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 914, in send
    response = self._send_handling_auth(
        request,
    ...<2 lines>...
        history=[],
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
        request,
        follow_redirects=follow_redirects,
        history=history,
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 1014, in _send_single_request
    response = transport.handle_request(request)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 249, in handle_request
    with map_httpcore_exceptions():
         ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\pivac\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 118, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [WinError 10054] Foi forçado o cancelamento de uma conexão existente pelo host remoto

[2025-05-19 23:13:44,748] INFO in main: Embrapa API is shutting down.
[2025-05-19 23:13:46,030] INFO in main: Embrapa API started in development mode.
[2025-05-19 23:15:57,898] INFO in main: Embrapa API is shutting down.
[2025-05-19 23:15:59,200] INFO in main: Embrapa API started in development mode.
[2025-05-19 23:16:00,544] INFO in main: Embrapa API started in development mode.
[2025-05-19 23:16:06,033] INFO in main: Embrapa API is shutting down.
[2025-05-19 23:16:11,300] INFO in main: Embrapa API started in development mode.
[2025-05-19 23:16:31,989] ERROR in production: Error scraping production data:
Traceback (most recent call last):
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 101, in map_httpcore_exceptions
    yield
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 250, in handle_request
    resp = self._pool.handle_request(req)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection_pool.py", line 256, in handle_request
    raise exc from None
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection_pool.py", line 236, in handle_request
    response = connection.handle_request(
        pool_request.request
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection.py", line 101, in handle_request
    raise exc
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection.py", line 78, in handle_request
    stream = self._connect(request)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_sync\connection.py", line 156, in _connect
    stream = stream.start_tls(**kwargs)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_backends\sync.py", line 154, in start_tls
    with map_exceptions(exc_map):
         ~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\pivac\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpcore\_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [WinError 10054] Foi forçado o cancelamento de uma conexão existente pelo host remoto

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\PosML\Fase 1\techchallenge\embrapa_api\app\scraping\production.py", line 13, in fetch_production_data
    response = httpx.get(url, timeout=10, headers=headers)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_api.py", line 195, in get
    return request(
        "GET",
    ...<9 lines>...
        trust_env=trust_env,
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_api.py", line 109, in request
    return client.request(
           ~~~~~~~~~~~~~~^
        method=method,
        ^^^^^^^^^^^^^^
    ...<8 lines>...
        follow_redirects=follow_redirects,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 825, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 914, in send
    response = self._send_handling_auth(
        request,
    ...<2 lines>...
        history=[],
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
        request,
        follow_redirects=follow_redirects,
        history=history,
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_client.py", line 1014, in _send_single_request
    response = transport.handle_request(request)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 249, in handle_request
    with map_httpcore_exceptions():
         ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\pivac\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\httpx\_transports\default.py", line 118, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [WinError 10054] Foi forçado o cancelamento de uma conexão existente pelo host remoto

[2025-05-19 23:26:49,628] INFO in main: Embrapa API is shutting down.
[2025-05-19 23:26:54,613] INFO in main: Embrapa API started in development mode.
[2025-05-19 23:26:59,229] ERROR in production: Error scraping production data:
Traceback (most recent call last):
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\pandas\compat\_optional.py", line 135, in import_optional_dependency
    module = importlib.import_module(name)
  File "C:\Users\pivac\AppData\Local\Programs\Python\Python313\Lib\importlib\__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1310, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1324, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'lxml'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\PosML\Fase 1\techchallenge\embrapa_api\app\scraping\production.py", line 22, in fetch_production_data
    df = pd.read_html(str(table))[0]
         ~~~~~~~~~~~~^^^^^^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\pandas\io\html.py", line 1240, in read_html
    return _parse(
        flavor=flavor,
    ...<16 lines>...
        storage_options=storage_options,
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\pandas\io\html.py", line 971, in _parse
    parser = _parser_dispatch(flav)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\pandas\io\html.py", line 918, in _parser_dispatch
    import_optional_dependency("lxml.etree")
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\pandas\compat\_optional.py", line 138, in import_optional_dependency
    raise ImportError(msg)
ImportError: Missing optional dependency 'lxml'.  Use pip or conda to install lxml.

[2025-05-19 23:27:02,077] ERROR in production: Error scraping production data:
Traceback (most recent call last):
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\pandas\compat\_optional.py", line 135, in import_optional_dependency
    module = importlib.import_module(name)
  File "C:\Users\pivac\AppData\Local\Programs\Python\Python313\Lib\importlib\__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1310, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1324, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'lxml'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\PosML\Fase 1\techchallenge\embrapa_api\app\scraping\production.py", line 22, in fetch_production_data
    df = pd.read_html(str(table))[0]
         ~~~~~~~~~~~~^^^^^^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\pandas\io\html.py", line 1240, in read_html
    return _parse(
        flavor=flavor,
    ...<16 lines>...
        storage_options=storage_options,
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\pandas\io\html.py", line 971, in _parse
    parser = _parser_dispatch(flav)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\pandas\io\html.py", line 918, in _parser_dispatch
    import_optional_dependency("lxml.etree")
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\pandas\compat\_optional.py", line 138, in import_optional_dependency
    raise ImportError(msg)
ImportError: Missing optional dependency 'lxml'.  Use pip or conda to install lxml.

[2025-05-19 23:27:03,566] ERROR in production: Error scraping production data:
Traceback (most recent call last):
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\pandas\compat\_optional.py", line 135, in import_optional_dependency
    module = importlib.import_module(name)
  File "C:\Users\pivac\AppData\Local\Programs\Python\Python313\Lib\importlib\__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1310, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1324, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'lxml'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\PosML\Fase 1\techchallenge\embrapa_api\app\scraping\production.py", line 22, in fetch_production_data
    df = pd.read_html(str(table))[0]
         ~~~~~~~~~~~~^^^^^^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\pandas\io\html.py", line 1240, in read_html
    return _parse(
        flavor=flavor,
    ...<16 lines>...
        storage_options=storage_options,
    )
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\pandas\io\html.py", line 971, in _parse
    parser = _parser_dispatch(flav)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\pandas\io\html.py", line 918, in _parser_dispatch
    import_optional_dependency("lxml.etree")
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\pandas\compat\_optional.py", line 138, in import_optional_dependency
    raise ImportError(msg)
ImportError: Missing optional dependency 'lxml'.  Use pip or conda to install lxml.

[2025-05-19 23:28:10,680] INFO in main: Embrapa API is shutting down.
[2025-05-19 23:28:50,445] INFO in main: Embrapa API started in development mode.
[2025-05-19 23:28:52,561] ERROR in production: Error scraping production data:
Traceback (most recent call last):
  File "D:\PosML\Fase 1\techchallenge\embrapa_api\app\scraping\production.py", line 23, in fetch_production_data
    df.columns = df.columns.str.strip()
                 ^^^^^^^^^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\pandas\core\accessor.py", line 224, in __get__
    accessor_obj = self._accessor(obj)
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\pandas\core\strings\accessor.py", line 191, in __init__
    self._inferred_dtype = self._validate(data)
                           ~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\pivac\AppData\Local\pypoetry\Cache\virtualenvs\embrapa-api-0YcYUUZG-py3.13\Lib\site-packages\pandas\core\strings\accessor.py", line 245, in _validate
    raise AttributeError("Can only use .str accessor with string values!")
AttributeError: Can only use .str accessor with string values!

[2025-05-20 00:04:29,115] INFO in main: Embrapa API is shutting down.
[2025-05-20 00:04:30,344] INFO in main: Embrapa API started in development mode.
[2025-05-20 00:04:31,557] INFO in main: Embrapa API started in development mode.
[2025-05-20 00:04:55,875] INFO in main: Embrapa API started in development mode.
[2025-05-20 00:08:39,141] INFO in main: Embrapa API is shutting down.
[2025-05-20 00:08:40,433] INFO in main: Embrapa API started in development mode.
[2025-05-20 00:09:06,217] INFO in main: Embrapa API started in development mode.
[2025-05-20 00:09:18,733] INFO in main: Embrapa API is shutting down.
[2025-05-20 00:09:20,051] INFO in main: Embrapa API started in development mode.
[2025-05-20 00:09:24,080] INFO in main: Embrapa API is shutting down.
[2025-05-20 00:09:48,730] INFO in main: Embrapa API started in development mode.
[2025-05-20 00:10:05,538] INFO in main: Embrapa API is shutting down.
[2025-05-20 00:12:20,763] INFO in main: Embrapa API started in development mode.
[2025-05-20 00:12:55,218] INFO in main: Embrapa API is shutting down.
[2025-05-20 00:14:51,377] INFO in main: Embrapa API started in development mode.
[2025-05-20 00:14:54,086] INFO in production: Production data scraped successfully from Embrapa.
[2025-05-20 00:17:30,491] INFO in main: Embrapa API is shutting down.
[2025-05-20 00:17:31,744] INFO in main: Embrapa API started in development mode.
[2025-05-20 00:17:33,050] INFO in main: Embrapa API started in development mode.
[2025-05-20 00:17:54,850] INFO in main: Embrapa API is shutting down.
[2025-05-20 00:17:56,156] INFO in main: Embrapa API started in development mode.
[2025-05-20 00:18:09,608] INFO in main: Embrapa API is shutting down.
[2025-05-20 00:18:23,211] INFO in main: Embrapa API started in development mode.
[2025-05-20 00:18:24,836] INFO in production: Production data scraped successfully from Embrapa.
[2025-05-20 00:18:25,665] INFO in production: Production data scraped successfully from Embrapa.
[2025-05-20 00:29:31,305] INFO in main: Embrapa API is shutting down.
[2025-05-20 00:29:32,643] INFO in main: Embrapa API started in development mode.
[2025-05-20 00:29:55,168] INFO in main: Embrapa API is shutting down.
[2025-05-20 00:29:56,467] INFO in main: Embrapa API started in development mode.
[2025-05-20 00:30:31,685] INFO in main: Embrapa API is shutting down.
[2025-05-20 00:30:32,956] INFO in main: Embrapa API started in development mode.
[2025-05-20 00:30:34,315] INFO in main: Embrapa API started in development mode.
[2025-05-20 00:30:39,701] INFO in main: Embrapa API is shutting down.
[2025-05-20 00:30:41,055] INFO in main: Embrapa API started in development mode.
[2025-05-20 00:36:27,333] INFO in main: Embrapa API is shutting down.
[2025-05-20 02:41:16,041] INFO in main: Embrapa API started in development mode.
[2025-05-20 02:41:45,239] INFO in main: Embrapa API is shutting down.
[2025-05-20 02:41:50,169] INFO in main: Embrapa API started in development mode.
[2025-05-20 02:42:00,289] INFO in main: Embrapa API is shutting down.
[2025-05-20 02:42:09,354] INFO in main: Embrapa API started in development mode.
[2025-05-20 02:42:56,601] INFO in main: Embrapa API is shutting down.
[2025-05-20 02:42:57,838] INFO in main: Embrapa API started in development mode.
[2025-05-20 02:43:14,480] INFO in main: Embrapa API is shutting down.
[2025-05-20 02:43:15,695] INFO in main: Embrapa API started in development mode.
[2025-05-20 02:43:17,036] INFO in main: Embrapa API is shutting down.
[2025-05-20 02:43:22,185] INFO in main: Embrapa API started in development mode.
[2025-05-20 02:43:35,721] INFO in production: Production data scraped, structured, and total included.
[2025-05-20 02:44:04,273] INFO in production: Production data scraped, structured, and total included.
[2025-05-20 02:46:20,107] INFO in main: Embrapa API is shutting down.
[2025-05-20 02:46:21,410] INFO in main: Embrapa API started in development mode.
[2025-05-20 02:46:46,846] INFO in main: Embrapa API is shutting down.
[2025-05-20 02:47:04,086] INFO in production: Production data scraped, structured, and total included.
[2025-05-20 03:01:43,250] INFO in main: Embrapa API started in development mode.
[2025-05-20 03:01:56,156] INFO in production: 48 registros extraídos para o ano 2022.
[2025-05-20 03:05:56,426] INFO in main: Embrapa API is shutting down.
[2025-05-20 21:33:11,664] INFO in main: Embrapa API started in development mode.
[2025-05-20 21:35:55,298] INFO in production: 48 registros extraídos para o ano 1970.
[2025-05-24 09:28:56,240] INFO in main: Embrapa API is shutting down.
[2025-05-24 11:40:19,390] INFO in main: Embrapa API started in development mode.
[2025-05-24 11:41:36,044] INFO in production: 48 registros extraídos para o ano 2022.
[2025-05-24 11:42:14,970] INFO in main: Embrapa API is shutting down.
[2025-05-24 12:39:53,600] INFO in main: Embrapa API started in development mode.
[2025-05-24 12:41:18,635] INFO in production: 52 registros extraídos para o ano 2020.
[2025-05-24 12:48:52,037] INFO in main: Embrapa API is shutting down.
